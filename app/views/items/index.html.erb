<% provide(:title, "All Items")%>

<main class="page-body">
<%= render "shared/flash" %>
    <h2>Item List</h2>
    <div id="items">
     <% if !@items.empty? %>
        <table class="table table-striped table-hover table-bordered text-center">
          <thead class="table-dark">
            <tr>
              <th>Item name</th>
              <th>Current Stock</th>
              <th>Total Stock</th>
              <th>Price</th>
              <th>Quantity</th>
              <% if current_user.admin? %>
                <th colspan="3"></th>
              <% else %>
                <th colspan="2"></th>
              <% end %>
            </tr>
          </thead>
          <tbody> 
            <% @items.each do |item| %>
                <tr>
                  <td><%= item.name %></td>
                  <td><%= item.in_stock %></td>
                  <td><%= item.total_stock %></td>
                  <td><%= item.price %></td>
                  <td><%= item.quantity %></td>


                  <td>
                    <div class=" dropdown">
                    <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
                      Show
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                      <li>
                          <%= link_to "Details", item, class: "btn btn-link" %>
                      </li>
                      <li>
                          <%= link_to "Allotments", allotments_item_path(item), class: "btn btn-link" %>
                      </li>                    
                    </ul>
                  </div>
                  </td>


                  <% if current_user.admin? %>
                    <td><%= link_to "Edit", edit_item_path(item), class: "btn btn-info"%></td>
                    <td><%= link_to "Destroy", item, method: :delete, data: {confirm: 'Are you sure?' }, class: "btn btn-danger" %></td> 
                  <% end %>
                  
                </tr> 
            <% end %>        
          </tbody>    
        </table> 
      <% else %>
        <p class="text-center">No Items found! <br/>
        Click Add Item button to add new item.</p>
      <% end %>
    </div>
    <% if current_user.admin? %>
      <br/>
      <%= link_to "Add Item", new_item_path, class:"btn btn-secondary" %>
    <% end %>
</main>
  